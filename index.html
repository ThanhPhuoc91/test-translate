<!DOCTYPE html>
<html>
<head>
    <title>Dịch Trung - Việt (Pollinations.AI)</title>
    <style>
        body { font-family: sans-serif; }
        #input-text { width: 100%; height: 200px; margin-bottom: 10px; }
        #translated-text { border: 1px solid #ccc; padding: 10px; white-space: pre-wrap; }
        .container { width: 80%; max-width: 900px; margin: 0 auto; padding: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Dịch Trung - Việt (Pollinations.AI)</h1>

        <textarea id="input-text" placeholder="Nhập văn bản tiếng Trung vào đây..."></textarea>
        <button id="translate-button">Dịch sang tiếng Việt</button>

        <h2>Văn bản đã dịch:</h2>
        <div id="translated-text">
            </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const inputTextElement = document.getElementById('input-text');
            const translatedTextElement = document.getElementById('translated-text');
            const translateButton = document.getElementById('translate-button');

            const apiUrl = 'https://text.pollinations.ai/'; // Endpoint API của Pollinations.AI

            translateButton.addEventListener('click', function() {
                const chineseText = inputTextElement.value.trim();
                if (!chineseText) {
                    alert("Vui lòng nhập văn bản tiếng Trung để dịch.");
                    return;
                }

                translatedTextElement.textContent = "Đang dịch..."; // Hiển thị trạng thái

                const requestBody = JSON.stringify({
                    messages: [
                        {
                            role: "user",
                            content: `Dịch đoạn văn bản tiếng Trung sau sang tiếng Việt: "${chineseText}"`
                        }
                    ],
                    model: 'openai' // Sử dụng model 'openai' cho dịch thuật, có thể thử 'mistral'
                });

                fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: requestBody
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Lỗi HTTP! trạng thái: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data && data.response) {
                        translatedTextElement.textContent = data.response.trim();
                    } else {
                        translatedTextElement.textContent = "Không thể dịch. Phản hồi không hợp lệ từ API.";
                    }
                })
                .catch(error => {
                    console.error("Lỗi khi gọi Pollinations.AI API:", error);
                    translatedTextElement.textContent = "Lỗi dịch thuật. Vui lòng thử lại sau.";
                });
            });

            // **Tự động dịch nếu có tham số 'text' trên URL (giống Baidu Translate)**
            const urlParams = new URLSearchParams(window.location.search);
            const textFromUrl = urlParams.get('text');
            if (textFromUrl) {
                inputTextElement.value = decodeURIComponent(textFromUrl); // Giải mã URL encoded text
                translateButton.click(); // Tự động kích hoạt dịch
            }
        });
    </script>
</body>
</html>
